#!/bin/bash

# Default to removing one argument when output is not to TTY
numberArgsToRemove=1;

# If the first option is a number...
if [ ! -z "${1##*[!0-9]*}" ]; then
    # ...it is specifying the number of args to remove when not outputing to TTY
    numberArgsToRemove=${1}
    # Remove the number from the args
    shift 1
fi

# Run the command and pipe to less only if output is to TTY
if [ -t 1 ]; then
    #  Need to set this option so that we can get the retun status of the cmd
    set -o pipefail

    # Run the command
    ${@} | less -FRX
else # Output is to non TTY...
    # Save the name of the command...
    cmd=${1}
    # ...and remove it from the args
    shift 1

    # Remove the args that are only for TTY output, they are expected to be the
    # first options after the command name.
    shift ${numberArgsToRemove}

    # Run the command with the remaing args
    ${cmd} ${@}
fi

exit ${?}
